{{ define "main" }}
<h1>{{ .Title }}</h1>

{{ range .Paginator.Pages }}
<article class="post-entry">
  {{ $imagePath := "" }}
  {{ if .Params.image }}
    {{ $imagePath = .Params.image }}
  {{ else }}
    {{ $content := .Content }}
    {{ $matches := findRE "!\\[.*?\\]\\((/[^)]+)\\)" $content 1 }}
    {{ if $matches }}
      {{ $imagePath = replaceRE "!\\[.*?\\]\\((/[^)]+)\\)" "$1" (index $matches 0) }}
    {{ end }}
  {{ end }}
  
  {{ if $imagePath }}
  <div class="post-preview-image" style="width: 100%; height: 200px; overflow: hidden; margin-bottom: 1rem;">
    <img src="{{ $imagePath }}" alt="{{ .Title }}" style="width: 100%; height: 100%; object-fit: cover;">
  </div>
  {{ end }}
  
  <header class="entry-header">
    <h2 class="entry-hint-parent">{{ .Title }}</h2>
  </header>
  <div class="entry-content">
    <p>{{ .Summary }}</p>
  </div>
  <footer class="entry-footer">
    {{ partial "post_meta.html" . }}
  </footer>
  <a class="entry-link" aria-label="post link to {{ .Title }}" href="{{ .Permalink }}"></a>
</article>
{{ end }}

{{ template "_internal/pagination.html" . }}
{{ end }}
