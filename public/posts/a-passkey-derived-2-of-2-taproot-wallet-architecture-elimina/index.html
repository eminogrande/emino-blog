<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing | Emino.App's, Art's & Articles by Emin Mahrt</title><meta name=keywords content="email-post"><meta name=description content="This post
describes a wallet architecture that removes seed phrases entirely, avoids
storing long-term private keys, and mitigates one of the largest practical
threats to software wallets today: compromise of the client application&rsquo;s
dependency graph or build pipeline.
The design employs two independent passkeys, each bound to a different
domain and each invoking the WebAuthn PRF extension to derive
deterministic key material. These two keys form a 2-of-2 MuSig Taproot
aggregated key, requiring both signatures for every spend. One signing
flow occurs inside the user&rsquo;s application environment, and the second
occurs on a completely separate, isolated co-signing domain with
user-visible transaction decoding."><meta name=author content="Emin Henri Mahrt"><link rel=canonical href=https://emino.app/posts/a-passkey-derived-2-of-2-taproot-wallet-architecture-elimina/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://emino.app/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://emino.app/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://emino.app/favicon-32x32.png><link rel=apple-touch-icon href=https://emino.app/apple-touch-icon.png><link rel=mask-icon href=https://emino.app/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://emino.app/posts/a-passkey-derived-2-of-2-taproot-wallet-architecture-elimina/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://emino.app/posts/a-passkey-derived-2-of-2-taproot-wallet-architecture-elimina/"><meta property="og:site_name" content="Emino.App's, Art's & Articles by Emin Mahrt"><meta property="og:title" content="A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing"><meta property="og:description" content="This post describes a wallet architecture that removes seed phrases entirely, avoids storing long-term private keys, and mitigates one of the largest practical threats to software wallets today: compromise of the client application’s dependency graph or build pipeline.
The design employs two independent passkeys, each bound to a different domain and each invoking the WebAuthn PRF extension to derive deterministic key material. These two keys form a 2-of-2 MuSig Taproot aggregated key, requiring both signatures for every spend. One signing flow occurs inside the user’s application environment, and the second occurs on a completely separate, isolated co-signing domain with user-visible transaction decoding."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-02T09:50:01+00:00"><meta property="article:modified_time" content="2025-12-02T09:50:01+00:00"><meta property="article:tag" content="Email-Post"><meta name=twitter:card content="summary"><meta name=twitter:title content="A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing"><meta name=twitter:description content="This post
describes a wallet architecture that removes seed phrases entirely, avoids
storing long-term private keys, and mitigates one of the largest practical
threats to software wallets today: compromise of the client application&rsquo;s
dependency graph or build pipeline.
The design employs two independent passkeys, each bound to a different
domain and each invoking the WebAuthn PRF extension to derive
deterministic key material. These two keys form a 2-of-2 MuSig Taproot
aggregated key, requiring both signatures for every spend. One signing
flow occurs inside the user&rsquo;s application environment, and the second
occurs on a completely separate, isolated co-signing domain with
user-visible transaction decoding."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://emino.app/posts/"},{"@type":"ListItem","position":2,"name":"A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing","item":"https://emino.app/posts/a-passkey-derived-2-of-2-taproot-wallet-architecture-elimina/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing","name":"A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing","description":"This post describes a wallet architecture that removes seed phrases entirely, avoids storing long-term private keys, and mitigates one of the largest practical threats to software wallets today: compromise of the client application\u0026rsquo;s dependency graph or build pipeline.\nThe design employs two independent passkeys, each bound to a different domain and each invoking the WebAuthn PRF extension to derive deterministic key material. These two keys form a 2-of-2 MuSig Taproot aggregated key, requiring both signatures for every spend. One signing flow occurs inside the user\u0026rsquo;s application environment, and the second occurs on a completely separate, isolated co-signing domain with user-visible transaction decoding.\n","keywords":["email-post"],"articleBody":"This post describes a wallet architecture that removes seed phrases entirely, avoids storing long-term private keys, and mitigates one of the largest practical threats to software wallets today: compromise of the client application’s dependency graph or build pipeline.\nThe design employs two independent passkeys, each bound to a different domain and each invoking the WebAuthn PRF extension to derive deterministic key material. These two keys form a 2-of-2 MuSig Taproot aggregated key, requiring both signatures for every spend. One signing flow occurs inside the user’s application environment, and the second occurs on a completely separate, isolated co-signing domain with user-visible transaction decoding.\nThe architecture is built to address specific weaknesses in conventional wallet designs, including seed-phrase exposure, blind signing, and dependency-chain compromise.\n1. Motivation 1.1 Seed phrase exposure during import Seed-phrase–based wallets require the user to type or paste a BIP-39 mnemonic or private key during wallet creation or recovery. This moment is extremely fragile:\nMnemonics appear in plaintext in memory, visible to any malicious script or compromised dependency. Clipboard use exposes secrets to OS-level observers or background applications. Mobile and web environments permit DOM injection, overlay attacks, accessibility scraping, or clipboard listeners. Even brief exposure is enough for silent key theft. If the application itself (or its dependencies) is compromised, a seed phrase can be exfiltrated the instant it touches memory. Eliminating this step entirely removes one of the largest security liabilities in software wallets.\n1.2 Supply-chain compromise Modern front-end stacks (React, React Native, Expo, etc.) routinely incorporate hundreds of transitive dependencies. A single dependency update or injected build-step modification can:\nTransmit sensitive material over the network Alter transaction parameters Manipulate UI rendering of transaction data Log or forward key material When a wallet relies on a single private key stored or derived within such an environment, a supply-chain compromise allows complete and silent draining of user funds.\n1.3 Blind signing and misrepresentation In single-environment wallets, the application that constructs the transaction is the same one that displays the transaction summary and performs the signing. A compromised or manipulated UI can:\nModify destination addresses Misrepresent amounts or fees Construct valid signatures over malicious transactions while showing benign data Without an independent verification step, the user cannot detect tampering.\n2. Architectural Overview The system uses two passkeys:\nPasskey A Registered to RPID nuri.com and used in the client application (web, iOS, Android).\nPasskey B Registered to RPID confirm.nuri.com and used exclusively on a separate co-signing website.\nBoth passkeys use the WebAuthn PRF extension, yielding deterministic high-entropy PRF outputs:\nPRF_A → used to derive signing key k₁ PRF_B → used to derive signing key k₂ These keys are combined into a MuSig 2-of-2 Taproot key, producing a single aggregated on-chain public key. Spending from the Taproot output requires both partial signatures.\nThe application environment controls one signing factor. A separate web domain controls the second. Neither domain can access the passkey of the other due to the RPID boundary enforced by the platform.\n3. Signing Flow 3.1 Transaction preparation and partial signing (nuri.com) The user constructs a transaction inside the application. The application creates a PSBT (inputs, outputs, fees). The user authenticates with Passkey A, generating PRF_A. A deterministic KDF derives the key k₁. The application creates a partial MuSig signature using k₁. The partially signed PSBT is forwarded to the independent co-signing domain. The application cannot finalize the transaction. A compromised client can only prepare a PSBT—not complete it.\n3.2 Independent verification and co-signing (confirm.nuri.com) The user is redirected to the co-signing site. This domain is isolated from the app by the browser and the WebAuthn RPID model. The co-signing server independently parses and decodes the PSBT. It displays a clear, human-readable summary of the spend: Inputs and amounts Destination addresses Fees Change outputs The user authenticates with Passkey B, producing PRF_B. A deterministic KDF derives key k₂. After validating the PSBT, the co-signer generates the second partial MuSig signature. PRF_B and k₂ are zeroized immediately. Nothing is stored server-side. The fully signed PSBT is returned to the application or broadcast to the network. This step provides both a second signature and an independent confirmation of intent, mitigating blind-signing attacks.\n4. Threat Analysis 4.1 Seed phrase risks eliminated No seed phrase is ever generated, displayed, entered, or stored. There is no clipboard exposure, no import form, no secret material in JavaScript memory, and no attack window during wallet creation.\n4.2 Protection against supply-chain compromise (client side) If the application or its dependencies are compromised:\nThe malicious code cannot derive k₂. It cannot impersonate confirm.nuri.com or invoke Passkey B. It cannot finalize the signature without the co-signer’s partial signature. The co-signer independently displays the true transaction details, making tampering visible. A client-only compromise is insufficient to steal funds.\n4.3 Protection against co-signer compromise If the co-signing server or its front-end is compromised:\nThe attacker cannot derive k₁. They cannot initiate a transaction because they cannot sign the first partial. They cannot obtain Passkey A’s PRF output due to RPID binding. A co-signer-only compromise is also insufficient to steal funds.\n4.4 Combined compromise requirement Fund theft requires coordinated compromise of:\nThe application supply chain and The co-signing site supply chain Or a phishing attack that manipulates transaction details on both sites in a consistent manner This significantly increases the difficulty of a successful attack.\n4.5 Blind signing mitigated Because transaction verification occurs at both:\nThe application (initial display) The co-signing domain (independent decoding and display) …the user receives two authenticated views of the same intent, closing the common blind-signing hole that afflicts single-environment wallets.\n4.6 No server-stored private keys The co-signer:\nStores no key material Derives k₂ only during the WebAuthn operation Immediately zeroizes all sensitive data There is no long-term key database to compromise.\n4.7 Domain isolation via WebAuthn RPID The RPID binding ensures:\nThe app cannot use Passkey B The co-signer cannot use Passkey A Phishing domains cannot reuse existing passkeys Mobile/native apps cannot trick the OS into unlocking a passkey for a different domain Hardware and OS enforce this isolation boundary.\n5. Resulting Security Properties Property Description No seed phrases No user-entered secrets; no import fields; no clipboard exposure Hardware-backed keys Secrets originate in Secure Enclave / FIDO authenticators 2-of-2 MuSig Both keys required; no unilateral spending Isolation via domains Two separate RPIDs, enforced by the platform Stateless co-signer No long-term keys; nothing to steal from the server Independent verification Prevents blind signing; detects tampered PSBTs Supply-chain resilience Single environment compromise is insufficient Cross-platform compatibility Works on web, iOS, Android without extensions 6. Conclusion This architecture addresses the primary attack vectors in software wallets:\nSeed phrase exposure Supply-chain compromise Blind-signing UI manipulation Single-key failure modes Server-side key theft By distributing signing authority across two independent domains, each backed by its own passkey and PRF output, and by requiring both signatures for every spend, the design substantially increases the security margin while remaining deployable in ordinary browsers and mobile apps.\nIt creates a practical path toward secure, cross-platform Bitcoin self-custody without seed phrases, without extensions, and without reliance on a trusted client software stack.\nIf needed, this can be expanded into a formal specification, security analysis, or developer implementation guide.\nPost created via email from emin@nuri.com\n","wordCount":"1196","inLanguage":"en","datePublished":"2025-12-02T09:50:01Z","dateModified":"2025-12-02T09:50:01Z","author":{"@type":"Person","name":"Emin Henri Mahrt"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://emino.app/posts/a-passkey-derived-2-of-2-taproot-wallet-architecture-elimina/"},"publisher":{"@type":"Organization","name":"Emino.App's, Art's \u0026 Articles by Emin Mahrt","logo":{"@type":"ImageObject","url":"https://emino.app/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://emino.app/ accesskey=h title="Emino.App's, Art's & Articles by Emin Mahrt (Alt + H)">Emino.App's, Art's & Articles by Emin Mahrt</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://emino.app/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://emino.app/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://emino.app/archives/ title=Archives><span>Archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://emino.app/>Home</a>&nbsp;»&nbsp;<a href=https://emino.app/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing</h1><div class=post-meta><span title='2025-12-02 09:50:01 +0000 UTC'>December 2, 2025</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Emin Henri Mahrt</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-motivation aria-label="1. Motivation">1. Motivation</a><ul><li><a href=#11-seed-phrase-exposure-during-import aria-label="1.1 Seed phrase exposure during import">1.1 Seed phrase exposure during import</a></li><li><a href=#12-supply-chain-compromise aria-label="1.2 Supply-chain compromise">1.2 Supply-chain compromise</a></li><li><a href=#13-blind-signing-and-misrepresentation aria-label="1.3 Blind signing and misrepresentation">1.3 Blind signing and misrepresentation</a></li></ul></li><li><a href=#2-architectural-overview aria-label="2. Architectural Overview">2. Architectural Overview</a></li><li><a href=#3-signing-flow aria-label="3. Signing Flow">3. Signing Flow</a><ul><li><a href=#31-transaction-preparation-and-partial-signing- aria-label="3.1 Transaction preparation and partial signing (nuri.com)">3.1 Transaction preparation and partial signing (nuri.com)</a></li><li><a href=#32-independent-verification-and-co-signing- aria-label="3.2 Independent verification and co-signing (confirm.nuri.com)">3.2 Independent verification and co-signing (confirm.nuri.com)</a></li></ul></li><li><a href=#4-threat-analysis aria-label="4. Threat Analysis">4. Threat Analysis</a><ul><li><a href=#41-seed-phrase-risks-eliminated aria-label="4.1 Seed phrase risks eliminated">4.1 Seed phrase risks eliminated</a></li><li><a href=#42-protection-against-supply-chain-compromise-client-side aria-label="4.2 Protection against supply-chain compromise (client side)">4.2 Protection against supply-chain compromise (client side)</a></li><li><a href=#43-protection-against-co-signer-compromise aria-label="4.3 Protection against co-signer compromise">4.3 Protection against co-signer compromise</a></li><li><a href=#44-combined-compromise-requirement aria-label="4.4 Combined compromise requirement">4.4 Combined compromise requirement</a></li><li><a href=#45-blind-signing-mitigated aria-label="4.5 Blind signing mitigated">4.5 Blind signing mitigated</a></li><li><a href=#46-no-server-stored-private-keys aria-label="4.6 No server-stored private keys">4.6 No server-stored private keys</a></li><li><a href=#47-domain-isolation-via-webauthn-rpid aria-label="4.7 Domain isolation via WebAuthn RPID">4.7 Domain isolation via WebAuthn RPID</a></li></ul></li><li><a href=#5-resulting-security-properties aria-label="5. Resulting Security Properties">5. Resulting Security Properties</a></li><li><a href=#6-conclusion aria-label="6. Conclusion">6. Conclusion</a></li></ul></div></details></div><div class=post-content><p>This post
describes a wallet architecture that removes seed phrases entirely, avoids
storing long-term private keys, and mitigates one of the largest practical
threats to software wallets today: compromise of the client application&rsquo;s
dependency graph or build pipeline.</p><p>The design employs two independent <strong>passkeys</strong>, each bound to a different
domain and each invoking the <strong>WebAuthn PRF extension</strong> to derive
deterministic key material. These two keys form a <strong>2-of-2 MuSig Taproot
aggregated key</strong>, requiring both signatures for every spend. One signing
flow occurs inside the user&rsquo;s application environment, and the second
occurs on a completely separate, isolated co-signing domain with
user-visible transaction decoding.</p><p>The architecture is built to address specific weaknesses in conventional
wallet designs, including seed-phrase exposure, blind signing, and
dependency-chain compromise.</p><hr><h2 id=1-motivation><strong>1. Motivation</strong><a hidden class=anchor aria-hidden=true href=#1-motivation>#</a></h2><h3 id=11-seed-phrase-exposure-during-import><strong>1.1 Seed phrase exposure during import</strong><a hidden class=anchor aria-hidden=true href=#11-seed-phrase-exposure-during-import>#</a></h3><p>Seed-phrase–based wallets require the user to type or paste a BIP-39
mnemonic or private key during wallet creation or recovery. This moment is
extremely fragile:</p><ul><li>Mnemonics appear in plaintext in memory, visible to any malicious script
or compromised dependency.</li><li>Clipboard use exposes secrets to OS-level observers or background
applications.</li><li>Mobile and web environments permit DOM injection, overlay attacks,
accessibility scraping, or clipboard listeners.</li><li>Even brief exposure is enough for silent key theft.</li></ul><p>If the application itself (or its dependencies) is compromised, a seed
phrase can be exfiltrated the instant it touches memory. Eliminating this
step entirely removes one of the largest security liabilities in software
wallets.</p><h3 id=12-supply-chain-compromise><strong>1.2 Supply-chain compromise</strong><a hidden class=anchor aria-hidden=true href=#12-supply-chain-compromise>#</a></h3><p>Modern front-end stacks (React, React Native, Expo, etc.) routinely
incorporate hundreds of transitive dependencies. A single dependency update
or injected build-step modification can:</p><ul><li>Transmit sensitive material over the network</li><li>Alter transaction parameters</li><li>Manipulate UI rendering of transaction data</li><li>Log or forward key material</li></ul><p>When a wallet relies on a single private key stored or derived within such
an environment, a supply-chain compromise allows complete and silent
draining of user funds.</p><h3 id=13-blind-signing-and-misrepresentation><strong>1.3 Blind signing and misrepresentation</strong><a hidden class=anchor aria-hidden=true href=#13-blind-signing-and-misrepresentation>#</a></h3><p>In single-environment wallets, the application that constructs the
transaction is the same one that displays the transaction summary and
performs the signing. A compromised or manipulated UI can:</p><ul><li>Modify destination addresses</li><li>Misrepresent amounts or fees</li><li>Construct valid signatures over malicious transactions while showing
benign data</li></ul><p>Without an independent verification step, the user cannot detect tampering.</p><hr><h2 id=2-architectural-overview><strong>2. Architectural Overview</strong><a hidden class=anchor aria-hidden=true href=#2-architectural-overview>#</a></h2><p>The system uses two passkeys:</p><ul><li><p><strong>Passkey A</strong>
Registered to RPID <code>nuri.com</code> and used in the client application (web, iOS,
Android).</p></li><li><p><strong>Passkey B</strong>
Registered to RPID <code>confirm.nuri.com</code> and used exclusively on a separate
co-signing website.</p></li></ul><p>Both passkeys use the <strong>WebAuthn PRF extension</strong>, yielding deterministic
high-entropy PRF outputs:</p><ul><li><code>PRF_A</code> → used to derive signing key <code>k₁</code></li><li><code>PRF_B</code> → used to derive signing key <code>k₂</code></li></ul><p>These keys are combined into a <strong>MuSig 2-of-2 Taproot key</strong>, producing a
single aggregated on-chain public key. Spending from the Taproot output
requires <strong>both partial signatures</strong>.</p><p>The application environment controls one signing factor.
A separate web domain controls the second.
Neither domain can access the passkey of the other due to the RPID boundary
enforced by the platform.</p><hr><h2 id=3-signing-flow><strong>3. Signing Flow</strong><a hidden class=anchor aria-hidden=true href=#3-signing-flow>#</a></h2><h3 id=31-transaction-preparation-and-partial-signing-><strong>3.1 Transaction preparation and partial signing (<code>nuri.com</code>)</strong><a hidden class=anchor aria-hidden=true href=#31-transaction-preparation-and-partial-signing->#</a></h3><ol><li>The user constructs a transaction inside the application.</li><li>The application creates a PSBT (inputs, outputs, fees).</li><li>The user authenticates with <strong>Passkey A</strong>, generating <code>PRF_A</code>.</li><li>A deterministic KDF derives the key <code>k₁</code>.</li><li>The application creates a partial MuSig signature using <code>k₁</code>.</li><li>The partially signed PSBT is forwarded to the independent co-signing
domain.</li></ol><p>The application cannot finalize the transaction. A compromised client can
only prepare a PSBT—not complete it.</p><hr><h3 id=32-independent-verification-and-co-signing-><strong>3.2 Independent verification and co-signing (<code>confirm.nuri.com</code>)</strong><a hidden class=anchor aria-hidden=true href=#32-independent-verification-and-co-signing->#</a></h3><ol><li>The user is redirected to the co-signing site.
This domain is isolated from the app by the browser and the WebAuthn RPID
model.</li><li>The co-signing server independently parses and decodes the PSBT.
It displays a clear, human-readable summary of the spend:</li></ol><ul><li>Inputs and amounts</li><li>Destination addresses</li><li>Fees</li><li>Change outputs</li></ul><ol start=3><li>The user authenticates with <strong>Passkey B</strong>, producing <code>PRF_B</code>.</li><li>A deterministic KDF derives key <code>k₂</code>.</li><li>After validating the PSBT, the co-signer generates the second partial
MuSig signature.</li><li><code>PRF_B</code> and <code>k₂</code> are zeroized immediately. Nothing is stored server-side.</li><li>The fully signed PSBT is returned to the application or broadcast to the
network.</li></ol><p>This step provides both a second signature and an independent confirmation
of intent, mitigating blind-signing attacks.</p><hr><h2 id=4-threat-analysis><strong>4. Threat Analysis</strong><a hidden class=anchor aria-hidden=true href=#4-threat-analysis>#</a></h2><h3 id=41-seed-phrase-risks-eliminated><strong>4.1 Seed phrase risks eliminated</strong><a hidden class=anchor aria-hidden=true href=#41-seed-phrase-risks-eliminated>#</a></h3><p>No seed phrase is ever generated, displayed, entered, or stored.
There is no clipboard exposure, no import form, no secret material in
JavaScript memory, and no attack window during wallet creation.</p><h3 id=42-protection-against-supply-chain-compromise-client-side><strong>4.2 Protection against supply-chain compromise (client side)</strong><a hidden class=anchor aria-hidden=true href=#42-protection-against-supply-chain-compromise-client-side>#</a></h3><p>If the application or its dependencies are compromised:</p><ul><li>The malicious code cannot derive <code>k₂</code>.</li><li>It cannot impersonate <code>confirm.nuri.com</code> or invoke Passkey B.</li><li>It cannot finalize the signature without the co-signer’s partial
signature.</li><li>The co-signer independently displays the true transaction details, making
tampering visible.</li></ul><p>A client-only compromise is insufficient to steal funds.</p><h3 id=43-protection-against-co-signer-compromise><strong>4.3 Protection against co-signer compromise</strong><a hidden class=anchor aria-hidden=true href=#43-protection-against-co-signer-compromise>#</a></h3><p>If the co-signing server or its front-end is compromised:</p><ul><li>The attacker cannot derive <code>k₁</code>.</li><li>They cannot initiate a transaction because they cannot sign the first
partial.</li><li>They cannot obtain Passkey A&rsquo;s PRF output due to RPID binding.</li></ul><p>A co-signer-only compromise is also insufficient to steal funds.</p><h3 id=44-combined-compromise-requirement><strong>4.4 Combined compromise requirement</strong><a hidden class=anchor aria-hidden=true href=#44-combined-compromise-requirement>#</a></h3><p>Fund theft requires coordinated compromise of:</p><ul><li>The application supply chain <strong>and</strong></li><li>The co-signing site supply chain</li><li>Or a phishing attack that manipulates transaction details on <strong>both</strong>
sites in a consistent manner</li></ul><p>This significantly increases the difficulty of a successful attack.</p><h3 id=45-blind-signing-mitigated><strong>4.5 Blind signing mitigated</strong><a hidden class=anchor aria-hidden=true href=#45-blind-signing-mitigated>#</a></h3><p>Because transaction verification occurs at both:</p><ul><li>The application (initial display)</li><li>The co-signing domain (independent decoding and display)</li></ul><p>…the user receives two authenticated views of the same intent, closing the
common blind-signing hole that afflicts single-environment wallets.</p><h3 id=46-no-server-stored-private-keys><strong>4.6 No server-stored private keys</strong><a hidden class=anchor aria-hidden=true href=#46-no-server-stored-private-keys>#</a></h3><p>The co-signer:</p><ul><li>Stores no key material</li><li>Derives k₂ only during the WebAuthn operation</li><li>Immediately zeroizes all sensitive data</li></ul><p>There is no long-term key database to compromise.</p><h3 id=47-domain-isolation-via-webauthn-rpid><strong>4.7 Domain isolation via WebAuthn RPID</strong><a hidden class=anchor aria-hidden=true href=#47-domain-isolation-via-webauthn-rpid>#</a></h3><p>The RPID binding ensures:</p><ul><li>The app cannot use Passkey B</li><li>The co-signer cannot use Passkey A</li><li>Phishing domains cannot reuse existing passkeys</li><li>Mobile/native apps cannot trick the OS into unlocking a passkey for a
different domain</li></ul><p>Hardware and OS enforce this isolation boundary.</p><hr><h2 id=5-resulting-security-properties><strong>5. Resulting Security Properties</strong><a hidden class=anchor aria-hidden=true href=#5-resulting-security-properties>#</a></h2><table><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td>No seed phrases</td><td>No user-entered secrets; no import fields; no clipboard</td></tr><tr><td>exposure</td><td></td></tr><tr><td>Hardware-backed keys</td><td>Secrets originate in Secure Enclave / FIDO</td></tr><tr><td>authenticators</td><td></td></tr><tr><td>2-of-2 MuSig</td><td>Both keys required; no unilateral spending</td></tr><tr><td>Isolation via domains</td><td>Two separate RPIDs, enforced by the platform</td></tr><tr><td>Stateless co-signer</td><td>No long-term keys; nothing to steal from the server</td></tr><tr><td></td><td></td></tr><tr><td>Independent verification</td><td>Prevents blind signing; detects tampered PSBTs</td></tr><tr><td></td><td></td></tr><tr><td>Supply-chain resilience</td><td>Single environment compromise is insufficient</td></tr><tr><td>Cross-platform compatibility</td><td>Works on web, iOS, Android without</td></tr><tr><td>extensions</td><td></td></tr></tbody></table><hr><h2 id=6-conclusion><strong>6. Conclusion</strong><a hidden class=anchor aria-hidden=true href=#6-conclusion>#</a></h2><p>This architecture addresses the primary attack vectors in software wallets:</p><ul><li>Seed phrase exposure</li><li>Supply-chain compromise</li><li>Blind-signing UI manipulation</li><li>Single-key failure modes</li><li>Server-side key theft</li></ul><p>By distributing signing authority across two independent domains, each
backed by its own passkey and PRF output, and by requiring both signatures
for every spend, the design substantially increases the security margin
while remaining deployable in ordinary browsers and mobile apps.</p><p>It creates a practical path toward secure, cross-platform Bitcoin
self-custody without seed phrases, without extensions, and without reliance
on a trusted client software stack.</p><p>If needed, this can be expanded into a formal specification, security
analysis, or developer implementation guide.</p><p><img alt=IMG_6836 loading=lazy src=/media/a-passkey-derived-2-of-2-taproot-wallet-architecture-elimina/IMG_6836.jpeg></p><hr><p><em>Post created via email from <a href=mailto:emin@nuri.com>emin@nuri.com</a></em></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://emino.app/tags/email-post/>Email-Post</a></li></ul><nav class=paginav><a class=next href=https://emino.app/posts/how-email-to-blog-publishing-works-on-emino-app/><span class=title>Next »</span><br><span>How Email‑to‑Blog Publishing Works on emino.app</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing on x" href="https://x.com/intent/tweet/?text=A%20Passkey-Derived%202-of-2%20Taproot%20Wallet%20Architecture%20Eliminating%20Seed%20Phrases%2c%20Mitigating%20Supply-Chain%20Risk%2c%20and%20Enforcing%20Verified%2c%20Non-Blind%20Signing&amp;url=https%3a%2f%2femino.app%2fposts%2fa-passkey-derived-2-of-2-taproot-wallet-architecture-elimina%2f&amp;hashtags=email-post"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2femino.app%2fposts%2fa-passkey-derived-2-of-2-taproot-wallet-architecture-elimina%2f&amp;title=A%20Passkey-Derived%202-of-2%20Taproot%20Wallet%20Architecture%20Eliminating%20Seed%20Phrases%2c%20Mitigating%20Supply-Chain%20Risk%2c%20and%20Enforcing%20Verified%2c%20Non-Blind%20Signing&amp;summary=A%20Passkey-Derived%202-of-2%20Taproot%20Wallet%20Architecture%20Eliminating%20Seed%20Phrases%2c%20Mitigating%20Supply-Chain%20Risk%2c%20and%20Enforcing%20Verified%2c%20Non-Blind%20Signing&amp;source=https%3a%2f%2femino.app%2fposts%2fa-passkey-derived-2-of-2-taproot-wallet-architecture-elimina%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing on reddit" href="https://reddit.com/submit?url=https%3a%2f%2femino.app%2fposts%2fa-passkey-derived-2-of-2-taproot-wallet-architecture-elimina%2f&title=A%20Passkey-Derived%202-of-2%20Taproot%20Wallet%20Architecture%20Eliminating%20Seed%20Phrases%2c%20Mitigating%20Supply-Chain%20Risk%2c%20and%20Enforcing%20Verified%2c%20Non-Blind%20Signing"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2femino.app%2fposts%2fa-passkey-derived-2-of-2-taproot-wallet-architecture-elimina%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing on whatsapp" href="https://api.whatsapp.com/send?text=A%20Passkey-Derived%202-of-2%20Taproot%20Wallet%20Architecture%20Eliminating%20Seed%20Phrases%2c%20Mitigating%20Supply-Chain%20Risk%2c%20and%20Enforcing%20Verified%2c%20Non-Blind%20Signing%20-%20https%3a%2f%2femino.app%2fposts%2fa-passkey-derived-2-of-2-taproot-wallet-architecture-elimina%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing on telegram" href="https://telegram.me/share/url?text=A%20Passkey-Derived%202-of-2%20Taproot%20Wallet%20Architecture%20Eliminating%20Seed%20Phrases%2c%20Mitigating%20Supply-Chain%20Risk%2c%20and%20Enforcing%20Verified%2c%20Non-Blind%20Signing&amp;url=https%3a%2f%2femino.app%2fposts%2fa-passkey-derived-2-of-2-taproot-wallet-architecture-elimina%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share A Passkey-Derived 2-of-2 Taproot Wallet Architecture Eliminating Seed Phrases, Mitigating Supply-Chain Risk, and Enforcing Verified, Non-Blind Signing on ycombinator" href="https://news.ycombinator.com/submitlink?t=A%20Passkey-Derived%202-of-2%20Taproot%20Wallet%20Architecture%20Eliminating%20Seed%20Phrases%2c%20Mitigating%20Supply-Chain%20Risk%2c%20and%20Enforcing%20Verified%2c%20Non-Blind%20Signing&u=https%3a%2f%2femino.app%2fposts%2fa-passkey-derived-2-of-2-taproot-wallet-architecture-elimina%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://emino.app/>Emino.App's, Art's & Articles by Emin Mahrt</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>